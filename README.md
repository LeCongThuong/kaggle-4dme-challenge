# 4DMR Kaggle Evaluation

> **Prerequisite:** Python 3.9 with `pip` available (Conda, venv, Docker, or Colab—your call).  CUDA 11.8 is recommended for GPU inference but not required.

---

## 1 · Clone the repository
```bash
git clone https://github.com/<your-org>/kaggle-4dmr-challenge.git
cd kaggle-4dmr-challenge
```

## 2 · Install Python dependencies
```bash
pip install -r requirements.txt
```
Dependencies are version-pinned in `requirements.txt`.

---

## 3 · Download the inference artifacts (~3 GB)
Run the helper script that lives in the repo:
```bash
bash download_artifacts.sh   # downloads & unzips into data/
```
After it finishes you should have:
```
data/inference_artifacts/
  ├─ checkpoint/best_scripted.pt
  └─ dataset/
       ├─ feat2d/
       ├─ feat3d/
       ├─ lr_image/          # pre-cropped faces
       └─ original_image/    # raw frames (optional)
```

---

## 4 · Produce the Kaggle submission CSV
```bash
python run_full.py --config exp.yaml
```

---

## 5 · Optional workflows

### 5.1 Preprocess dataset `lr_image/` (face crops)
```bash
python prep_faces.py --config exp.yaml
```

### 5.2 Re-extract 2‑D RADIO features
```bash
python extract_2d_features.py --config exp.yaml
```

### 5.3 Create 3‑D expression FaceVerse features
We use **FaceVerse v4** (<https://github.com/LizhenWangT/FaceVerse_v4>)

1. Follow FaceVerse’s README to regress FLAME expression parameters for each frame → `expr_<frame>.npy`.  
2. Place them under `dataset/feat3d/<seq_id>/` **or** point `--feat3d` to your directory.  
   The loader automatically keeps the expression subset (columns 156–326).

---

## 6 · Expected directory layout after a full run
```
kaggle-4dmr-challenge/
├─ data/
│   └─ inference_artifacts/
│       ├─ checkpoint/best_scripted.pt
│       └─ dataset/{feat2d, feat3d, lr_image, original_image}
├─ pretrained_models/radio/          # auto-downloaded RADIO weights
├─ submission.csv                    # generated by run_full.py
├─ download_artifacts.sh
├─ prep_faces.py
├─ extract_2d_features.py
├─ run_full.py
└─ requirements.txt
```

